# 轻量级云盘项目 - 产品需求文档 (PRD)

## 1. 项目概述

### 1.1 产品简介
基于 Vercel 部署的轻量级云盘系统，提供简单、直接的文件共享服务。用户通过特定的服务器链接访问独立的文件存储空间，可以上传和下载文件。

### 1.2 核心价值
- 零门槛文件共享：无需注册登录，通过链接即可访问
- 简洁高效：专注核心功能，避免复杂操作
- 安全隔离：每个链接对应独立存储空间
- 高可用性：基于 Vercel 平台，保证服务稳定性

## 2. 技术栈

- **框架**: Next.js (App Router)
- **语言**: TypeScript
- **样式**: Tailwind CSS
- **UI 组件**: shadcn/ui
- **图标**: Lucide React
- **文件存储**: Vercel Blob
- **部署平台**: Vercel

## 3. 功能需求

### 3.1 核心功能

#### 3.1.1 文件空间访问
- **功能描述**: 用户通过特定的服务器链接访问对应的文件存储空间
- **实现方式**: 
  - URL 路由包含唯一标识符（如 `/space/{spaceId}`）
  - 每个 `spaceId` 对应 Vercel Blob 中的独立存储目录
- **用户体验**: 
  - 直接访问链接即可进入文件空间
  - 页面显示当前空间的所有文件列表

#### 3.1.2 文件上传
- **功能描述**: 在文件空间内上传文件
- **技术要求**:
  - 支持多文件同时上传
  - 文件大小限制（根据 Vercel Blob 限制设定）
  - 支持拖拽上传
  - 上传进度显示
- **文件存储**: 
  - 文件存储到 Vercel Blob 对应的空间目录下
  - 文件名处理（重名文件自动重命名）
- **用户反馈**:
  - 上传成功/失败提示
  - 实时更新文件列表

#### 3.1.3 文件列表展示
- **功能描述**: 展示当前空间内的所有文件
- **显示信息**:
  - 文件名
  - 文件大小
  - 上传时间
  - 文件类型图标
- **交互功能**:
  - 文件排序（按名称、大小、时间）
  - 文件搜索/筛选

#### 3.1.4 文件下载
- **功能描述**: 下载空间内的文件
- **实现方式**:
  - 点击文件名或下载按钮触发下载
  - 生成临时下载链接
- **用户体验**:
  - 下载进度显示（大文件）
  - 支持断点续传

### 3.2 辅助功能

#### 3.2.1 文件管理
- **文件删除**: 
  - 删除确认弹窗
  - 批量删除功能
- **文件重命名**: 
  - 在线重命名
  - 重名检测

#### 3.2.2 空间管理
- **存储统计**: 
  - 显示空间使用情况
  - 文件总数统计
- **空间清理**: 
  - 一键清空空间
  - 定时清理过期文件（可选）

## 4. 用户体验设计

### 4.1 页面布局
- **顶部区域**: 空间标识、上传区域
- **主要内容区**: 文件列表
- **底部区域**: 存储统计信息

### 4.2 响应式设计
- 支持桌面端、平板、手机端访问
- 移动端优化的触摸交互

### 4.3 视觉设计
- 简洁现代的 UI 风格
- 使用 shadcn/ui 组件保证一致性
- 合理的颜色搭配和间距设计

## 5. 技术架构

### 5.1 前端架构
```
src/
├── app/
│   ├── space/[spaceId]/
│   │   └── page.tsx        # 文件空间页面
│   ├── api/
│   │   ├── upload/
│   │   │   └── route.ts    # 文件上传 API
│   │   ├── files/
│   │   │   └── route.ts    # 文件列表 API
│   │   └── delete/
│   │       └── route.ts    # 文件删除 API
│   └── globals.css
├── components/
│   ├── FileUploader.tsx    # 文件上传组件
│   ├── FileList.tsx        # 文件列表组件
│   ├── FileItem.tsx        # 文件项组件
│   └── SpaceInfo.tsx       # 空间信息组件
├── lib/
│   ├── blob.ts            # Vercel Blob 操作
│   ├── utils.ts           # 工具函数
│   └── types.ts           # 类型定义
└── hooks/
    ├── useFileUpload.ts   # 文件上传钩子
    └── useFileList.ts     # 文件列表钩子
```

### 5.2 后端 API 设计
- `GET /api/files?spaceId={id}` - 获取文件列表
- `POST /api/upload` - 上传文件
- `DELETE /api/files/{fileId}` - 删除文件
- `GET /api/download/{fileId}` - 生成下载链接

### 5.3 数据存储
- **文件存储**: Vercel Blob
- **元数据**: 可考虑使用 Vercel KV 或直接从 Blob 获取

## 6. 安全考虑

### 6.1 文件安全
- 文件类型白名单/黑名单
- 文件大小限制
- 病毒扫描（如需要）

### 6.2 访问控制
- 空间隔离：确保不同 spaceId 之间文件完全隔离
- 防止路径遍历攻击
- 文件名安全处理

### 6.3 滥用防护
- 上传频率限制
- 文件数量限制
- 总存储空间限制

## 7. 性能优化

### 7.1 前端优化
- 文件列表虚拟滚动（大量文件时）
- 图片文件预览缓存
- 懒加载文件缩略图

### 7.2 后端优化
- 文件上传分块处理
- CDN 加速文件下载
- 合理的缓存策略

## 8. 部署方案

### 8.1 Vercel 配置
- 环境变量配置
- Vercel Blob 存储配置
- 域名绑定

### 8.2 监控告警
- 存储使用量监控
- 访问量统计
- 错误日志收集

## 9. 后续扩展

### 9.1 短期扩展
- 文件预览功能（图片、文档）
- 文件夹支持
- 批量操作优化

### 9.2 长期扩展
- 用户系统（可选）
- 文件分享链接
- 访问统计分析
- 多语言支持

## 10. 风险评估

### 10.1 技术风险
- Vercel Blob 服务稳定性依赖
- 文件上传大小和数量限制
- 并发访问性能瓶颈

### 10.2 业务风险
- 存储成本控制
- 恶意文件上传风险
- 法律合规问题

## 11. 成功指标

- **功能指标**: 文件上传成功率 > 99%
- **性能指标**: 页面加载时间 < 3秒
- **用户体验**: 操作流程简洁直观
- **稳定性**: 服务可用率 > 99.9%